import{c as C,u as J,r as i,j as e,B as u}from"./index-fe6d2e52.js";import{I as x}from"./input-e5a38bac.js";import{L as g}from"./label-1a727cef.js";import{D as I}from"./date-picker-3c1e787d.js";import{S as L,a as F,b as T,c as z,d as M}from"./select-ae6383b7.js";import"./textarea-e623590e.js";import{C as E,a as A,b as O,c as U,d as V}from"./card-00c50818.js";import{m as B}from"./mockAccounts-dd656361.js";import{T as $}from"./trash-2-fd25eb8f.js";import{P}from"./plus-circle-ee65b1db.js";import{S as R}from"./save-39dd484b.js";import"./extends-b7a1e135.js";const q=C("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),ae=()=>{const{toast:n}=J(),[b,j]=i.useState(new Date),[p,v]=i.useState(`MJ-${String(Date.now()).slice(-6)}`),[k,N]=i.useState(""),[d,c]=i.useState([{id:Date.now()+1,accountId:"",debit:"",credit:"",lineNarration:""},{id:Date.now()+2,accountId:"",debit:"",credit:"",lineNarration:""}]),[o,f]=i.useState(0),[l,y]=i.useState(0);i.useEffect(()=>{let t=0,a=0;d.forEach(r=>{t+=parseFloat(r.debit)||0,a+=parseFloat(r.credit)||0}),f(parseFloat(t.toFixed(2))),y(parseFloat(a.toFixed(2)))},[d]);const S=()=>{c([...d,{id:Date.now(),accountId:"",debit:"",credit:"",lineNarration:""}])},D=t=>{if(d.length<=2){n({title:"Cannot Remove",description:"A journal entry must have at least two lines.",variant:"destructive"});return}c(d.filter(a=>a.id!==t))},m=(t,a,r)=>{c(d.map(s=>{if(s.id===t){const h={...s,[a]:r};return a==="debit"&&parseFloat(r)>0&&(h.credit=""),a==="credit"&&parseFloat(r)>0&&(h.debit=""),h}return s}))},w=t=>{if(t.preventDefault(),d.some(s=>!s.accountId||s.debit===""&&s.credit==="")){n({title:"Validation Error",description:"All lines must have an account and either a debit or credit amount.",variant:"destructive"});return}if(o!==l){n({title:"Validation Error",description:"Total Debits must equal Total Credits.",variant:"destructive"});return}if(o===0){n({title:"Validation Error",description:"Journal entry amounts cannot be zero.",variant:"destructive"});return}const a={id:`journal-${Date.now()}`,journalNumber:p,date:b,overallNarration:k,lines:d.filter(s=>s.accountId&&(s.debit!==""||s.credit!=="")),totalDebits:o,totalCredits:l};console.log("Manual Journal Data:",a);const r=JSON.parse(localStorage.getItem("manualJournals")||"[]");localStorage.setItem("manualJournals",JSON.stringify([...r,a])),n({title:"Manual Journal Saved",description:`Journal ${p} has been saved.`,className:"bg-green-500 text-white"}),j(new Date),N(""),c([{id:Date.now()+1,accountId:"",debit:"",credit:"",lineNarration:""},{id:Date.now()+2,accountId:"",debit:"",credit:"",lineNarration:""}]),v(`MJ-${String(Date.now()).slice(-6)}`)};return e.jsx("div",{className:"space-y-6",children:e.jsxs(E,{className:"shadow-xl border-border dark:border-dark-border",children:[e.jsx(A,{className:"bg-muted/50 dark:bg-dark-muted/50 p-6 border-b border-border dark:border-dark-border",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs(O,{className:"text-3xl font-bold text-primary dark:text-dark-primary flex items-center",children:[e.jsx(q,{size:32,className:"mr-3 text-accent dark:text-dark-accent"})," New Manual Journal"]}),e.jsx("div",{className:"text-muted-foreground dark:text-dark-muted-foreground font-mono text-sm bg-muted dark:bg-dark-muted px-2 py-1 rounded self-start sm:self-center",children:p})]})}),e.jsxs("form",{onSubmit:w,children:[e.jsxs(U,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{htmlFor:"journalDate",className:"font-semibold",children:["Date ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(I,{date:b,setDate:j,id:"journalDate"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"overallNarration",className:"font-semibold",children:"Overall Narration"}),e.jsx(x,{id:"overallNarration",value:k,onChange:t=>N(t.target.value),placeholder:"e.g., Year-end adjustments"})]})]}),e.jsx("div",{className:"overflow-x-auto border border-border dark:border-dark-border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-[700px]",children:[e.jsx("thead",{className:"bg-muted dark:bg-dark-muted",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"p-3 text-left text-sm font-semibold text-primary dark:text-dark-primary w-[35%]",children:["Account ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("th",{className:"p-3 text-right text-sm font-semibold text-primary dark:text-dark-primary w-[15%]",children:["Debit ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("th",{className:"p-3 text-right text-sm font-semibold text-primary dark:text-dark-primary w-[15%]",children:["Credit ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold text-primary dark:text-dark-primary w-[30%]",children:"Line Narration"}),e.jsx("th",{className:"p-3 text-center text-sm font-semibold text-primary dark:text-dark-primary w-[5%]"})]})}),e.jsx("tbody",{children:d.map((t,a)=>e.jsxs("tr",{className:"border-b border-border dark:border-dark-border last:border-b-0 hover:bg-muted/50 dark:hover:bg-dark-muted/50",children:[e.jsx("td",{className:"p-2",children:e.jsxs(L,{value:t.accountId,onValueChange:r=>m(t.id,"accountId",r),children:[e.jsx(F,{className:"text-sm",children:e.jsx(T,{placeholder:"Select account"})}),e.jsx(z,{children:B.map(r=>e.jsxs(M,{value:r.id,children:[r.name," (",r.category,")"]},r.id))})]})}),e.jsx("td",{className:"p-2",children:e.jsx(x,{type:"number",value:t.debit,onChange:r=>m(t.id,"debit",r.target.value),placeholder:"0.00",className:"w-full text-right text-sm",min:"0",step:"0.01",disabled:!!t.credit&&parseFloat(t.credit)>0})}),e.jsx("td",{className:"p-2",children:e.jsx(x,{type:"number",value:t.credit,onChange:r=>m(t.id,"credit",r.target.value),placeholder:"0.00",className:"w-full text-right text-sm",min:"0",step:"0.01",disabled:!!t.debit&&parseFloat(t.debit)>0})}),e.jsx("td",{className:"p-2",children:e.jsx(x,{value:t.lineNarration,onChange:r=>m(t.id,"lineNarration",r.target.value),placeholder:"Line specific note",className:"w-full text-sm"})}),e.jsx("td",{className:"p-2 text-center",children:e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>D(t.id),className:"text-destructive dark:text-red-400 hover:text-destructive/80 h-8 w-8",children:e.jsx($,{size:16})})})]},t.id))}),e.jsx("tfoot",{className:"bg-muted/70 dark:bg-dark-muted/70 font-semibold",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-3 text-right text-primary dark:text-dark-primary",children:"Totals:"}),e.jsx("td",{className:"p-3 text-right text-primary dark:text-dark-primary",children:o.toLocaleString("en-US",{style:"currency",currency:"USD"})}),e.jsx("td",{className:"p-3 text-right text-primary dark:text-dark-primary",children:l.toLocaleString("en-US",{style:"currency",currency:"USD"})}),e.jsx("td",{className:"p-3",colSpan:"2",children:o!==l&&e.jsxs("span",{className:"text-destructive dark:text-red-400 text-xs",children:["Debits and Credits must balance. Difference: ",(o-l).toLocaleString("en-US",{style:"currency",currency:"USD"})]})})]})})]})}),e.jsxs(u,{type:"button",onClick:S,variant:"outline",className:"mt-4 text-accent dark:text-dark-accent border-accent dark:border-dark-accent hover:bg-accent/10 dark:hover:bg-dark-accent/10",children:[e.jsx(P,{size:18,className:"mr-2"})," Add Line"]})]}),e.jsxs(V,{className:"bg-muted/30 dark:bg-dark-muted/30 rounded-b-lg p-6 flex justify-end space-x-3 border-t border-border dark:border-dark-border",children:[e.jsx(u,{type:"button",variant:"outline",children:"Cancel"}),e.jsxs(u,{type:"submit",className:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-dark-primary dark:text-dark-primary-foreground dark:hover:bg-dark-primary/90",children:[e.jsx(R,{size:18,className:"mr-2"})," Save Journal"]})]})]})]})})};export{ae as default};

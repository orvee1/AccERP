import{c as G,u as U,r as d,j as e,B as f}from"./index-fe6d2e52.js";import{I as w}from"./input-e5a38bac.js";import{D as H,a as M,b as J,c as K,d as R,e as Y,f as Q,g as W,h as z,i as X,j as Z,A as _,k as E,l as ee,m as re,n as ae,o as ne,p as se,q as te}from"./alert-dialog-e8612541.js";import{L as C}from"./label-1a727cef.js";import{D as de}from"./date-picker-3c1e787d.js";import{S as L}from"./save-39dd484b.js";import{C as oe,a as le,b as ce,c as ie}from"./card-00c50818.js";import{P as me}from"./plus-circle-ee65b1db.js";import{S as pe,P as ue,A as xe}from"./search-c0fd07d3.js";import{T as he}from"./trash-2-fd25eb8f.js";import"./extends-b7a1e135.js";const ge=G("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),be=({onSave:c,onCancel:m,initialData:s,isEditMode:a})=>{const{toast:p}=U(),[t,h]=d.useState(""),[v,b]=d.useState(""),[k,j]=d.useState(""),[V,g]=d.useState(""),[x,N]=d.useState(""),[y,S]=d.useState(void 0),[D,B]=d.useState(null);d.useEffect(()=>{var n;a&&s?(h(s.name||""),b(s.proprietorName||""),j(s.vendorNumber||""),g(s.address||""),N(((n=s.openingBalance)==null?void 0:n.toString())||""),S(s.openingBalanceDate?new Date(s.openingBalanceDate):void 0),B(s.id||s.vendorNumber)):A()},[s,a]);const A=()=>{h(""),b(""),j(""),g(""),N(""),S(void 0),B(null)},F=(n,$=!0)=>{if(n.preventDefault(),!t){p({title:"Validation Error",description:"Vendor Name is required.",variant:"destructive"});return}const I={id:D||`vend-${Date.now()}`,name:t,proprietorName:v,vendorNumber:k||(D?D.split("-")[1]||String(Date.now()).slice(-4):`V${String(Date.now()).slice(-4)}`),address:V,openingBalance:parseFloat(x)||0,openingBalanceDate:y?y.toISOString().split("T")[0]:null};c(I,a),p({title:`Vendor ${a?"Updated":"Saved"}!`,description:`${t} has been successfully ${a?"updated":"added"}.`}),$?m():a||A()};return e.jsxs("form",{onSubmit:n=>F(n,!0),className:"space-y-4 py-2",children:[e.jsxs(H,{className:"hidden",children:[e.jsx(M,{children:a?"Edit Vendor":"Add New Vendor"}),e.jsx(J,{children:a?"Update vendor details.":"Fill in the details to add a new vendor."})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"vendorName",children:["Vendor Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(w,{id:"vendorName",value:t,onChange:n=>h(n.target.value),placeholder:"e.g., Supplier Alpha Inc.",className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"proprietorName",children:"Proprietor Name"}),e.jsx(w,{id:"proprietorName",value:v,onChange:n=>b(n.target.value),placeholder:"e.g., John Doe",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"vendorNumber",children:"Vendor Number"}),e.jsx(w,{id:"vendorNumber",value:k,onChange:n=>j(n.target.value),placeholder:"e.g., V001",className:"mt-1",disabled:a}),a&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vendor number cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"address",children:"Address"}),e.jsx(w,{id:"address",value:V,onChange:n=>g(n.target.value),placeholder:"e.g., 123 Supply Chain Rd",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openingBalance",children:"Opening Balance"}),e.jsx(w,{id:"openingBalance",type:"number",value:x,onChange:n=>N(n.target.value),placeholder:"0.00",className:"mt-1",disabled:a}),a&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openingBalanceDate",children:"Opening Balance As of Date"}),e.jsx(de,{date:y,setDate:S,className:"mt-1 w-full",disabled:a}),a&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance date cannot be changed after creation."})]}),e.jsxs(K,{className:"pt-6",children:[e.jsx(R,{asChild:!0,children:e.jsx(f,{variant:"outline",onClick:m,children:"Cancel"})}),!a&&e.jsxs(f,{type:"button",onClick:n=>F(n,!1),variant:"secondary",children:[e.jsx(L,{size:18,className:"mr-2"})," Save & New"]}),e.jsxs(f,{type:"submit",children:[e.jsx(L,{size:18,className:"mr-2"})," ",a?"Update Vendor":"Save & Close"]})]})]})},P=[{id:"vend-001",name:"Supplier Alpha Inc.",proprietorName:"Mr. A",vendorNumber:"V001",address:"123 Supply St",balance:1500,openingBalance:1500,openingBalanceDate:"2023-01-01"},{id:"vend-002",name:"Service Provider Beta",proprietorName:"Ms. B",vendorNumber:"V002",address:"456 Service Ave",balance:0,openingBalance:0,openingBalanceDate:"2023-01-01"},{id:"vend-003",name:"Materials Inc.",proprietorName:"Dr. M",vendorNumber:"V003",address:"789 Material Rd",balance:3250.5,openingBalance:3250.5,openingBalanceDate:"2023-01-01"},{id:"vend-004",name:"Vendor Gamma Co.",proprietorName:"Prof. G",vendorNumber:"V004",address:"012 Gamma Blvd",balance:-500,openingBalance:-500,openingBalanceDate:"2023-01-01"}],O=c=>({...c,balanceFormatted:`${(c.balance||0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})} ${(c.balance||0)>=0?"(Payable)":"(Receivable)"}`}),q=({children:c,columnKey:m,sortConfig:s,requestSort:a,isTextRight:p=!1,className:t=""})=>{const h=s&&s.key===m,v=h?s.direction:null;return e.jsx("th",{scope:"col",className:`px-4 py-3 cursor-pointer hover:bg-primary/10 dark:hover:bg-dark-primary/10 transition-colors ${p?"text-right":"text-left"} ${t}`,onClick:()=>a(m),children:e.jsxs("div",{className:`flex items-center ${p?"justify-end":"justify-start"}`,children:[!p&&c,e.jsx("span",{className:`mx-1 ${p?"mr-0 ml-1":"ml-0 mr-1"}`,children:h?v==="ascending"?"▲":"▼":e.jsx(xe,{size:14,className:"opacity-40"})}),p&&c]})})},Be=()=>{const{toast:c}=U(),[m,s]=d.useState(()=>P.map(O)),[a,p]=d.useState(""),[t,h]=d.useState({key:"name",direction:"ascending"}),[v,b]=d.useState(!1),[k,j]=d.useState(null),[V,g]=d.useState(!1),[x,N]=d.useState(null);d.useEffect(()=>{const r=localStorage.getItem("vendors");r?s(JSON.parse(r).map(O)):localStorage.setItem("vendors",JSON.stringify(P))},[]);const y=r=>{localStorage.setItem("vendors",JSON.stringify(r.map(({balanceFormatted:o,...u})=>u)))},S=(r=null)=>{j(r),b(!0)},D=()=>{b(!1),j(null)},B=(r,o)=>{s(u=>{let l;if(o)l=u.map(i=>i.id===r.id?O({...i,...r,balance:r.openingBalance}):i);else{const i=O({...r,balance:r.openingBalance});l=[...u,i]}return y(l),l})},A=r=>{const o=m.find(u=>u.id===r);o&&(N(o),g(!0))},F=()=>{if(x){const r=m.filter(o=>o.id!==x.id);s(r),y(r),c({title:"Vendor Deleted",description:`${x.name} has been deleted.`,variant:"destructive"}),g(!1),N(null)}},n=()=>{c({title:"Import Vendors from Excel",description:"This feature will be available soon.",duration:3e3})},$=r=>p(r.target.value),I=r=>{let o="ascending";t&&t.key===r&&t.direction==="ascending"&&(o="descending"),h({key:r,direction:o})},T=d.useMemo(()=>{let r=[...m];if(a){const o=a.toLowerCase();r=r.filter(u=>Object.values(u).some(l=>String(l).toLowerCase().includes(o)))}return t!==null&&r.sort((o,u)=>{let l=o[t.key],i=u[t.key];return t.key==="balance"?(l=parseFloat(l)||0,i=parseFloat(i)||0):typeof l=="string"&&(l=l.toLowerCase(),i=i.toLowerCase()),l<i?t.direction==="ascending"?-1:1:l>i?t.direction==="ascending"?1:-1:0}),r},[a,t,m]);return e.jsx("div",{className:"space-y-6 p-1",children:e.jsxs(oe,{className:"shadow-lg border-border dark:border-dark-border",children:[e.jsx(le,{className:"bg-card dark:bg-dark-card rounded-t-lg p-4 md:p-6 border-b border-border dark:border-dark-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsxs(ce,{className:"text-2xl md:text-3xl font-bold text-primary dark:text-dark-primary flex items-center",children:[e.jsx(ge,{size:28,className:"mr-3 text-accent dark:text-dark-accent"})," Vendors"]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(Y,{children:[e.jsx(Q,{asChild:!0,children:e.jsxs(f,{variant:"outline",className:"text-primary dark:text-dark-primary border-primary dark:border-dark-primary hover:bg-primary/10 dark:hover:bg-dark-primary/10 shadow-sm",children:[e.jsx(me,{size:20,className:"mr-2"})," Add Vendor"]})}),e.jsxs(W,{align:"end",className:"bg-card dark:bg-dark-card shadow-lg rounded-md border border-border dark:border-dark-border",children:[e.jsx(z,{onClick:()=>S(null),className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Add New"}),e.jsx(z,{onClick:n,className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Import from Excel"})]})]})})]})}),e.jsxs(ie,{className:"p-4 md:p-6",children:[e.jsx(X,{open:v,onOpenChange:b,children:e.jsxs(Z,{className:"sm:max-w-[550px] bg-card dark:bg-dark-card text-foreground dark:text-dark-foreground border-border dark:border-dark-border shadow-2xl rounded-lg",children:[e.jsxs(H,{children:[e.jsx(M,{className:"text-primary dark:text-dark-primary text-2xl font-semibold",children:k?"Edit Vendor":"Add New Vendor"}),e.jsx(J,{className:"text-muted-foreground dark:text-dark-muted-foreground",children:k?"Update vendor details.":"Fill in the details to add a new vendor."})]}),e.jsx(be,{onSave:B,onCancel:D,initialData:k,isEditMode:!!k})]})}),e.jsx(_,{open:V,onOpenChange:g,children:e.jsxs(E,{children:[e.jsxs(ee,{children:[e.jsx(re,{children:"Are you absolutely sure?"}),e.jsxs(ae,{children:['This action cannot be undone. This will permanently delete the vendor "',x==null?void 0:x.name,'".']})]}),e.jsxs(ne,{children:[e.jsx(se,{onClick:()=>g(!1),children:"Cancel"}),e.jsx(te,{onClick:F,className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete vendor"})]})]})}),e.jsxs("div",{className:"mb-6 flex items-center space-x-2 p-3 bg-background dark:bg-dark-background rounded-lg shadow-sm border border-border dark:border-dark-border",children:[e.jsx(w,{type:"text",placeholder:"Search vendors (Name, Balance...)",className:"flex-grow focus:ring-accent dark:focus:ring-dark-accent border-input dark:border-dark-input focus:border-primary dark:focus:border-dark-primary",value:a,onChange:$}),e.jsxs(f,{className:"bg-primary text-primary-foreground hover:bg-primary-hover dark:bg-dark-primary dark:text-dark-primary-foreground dark:hover:bg-dark-primary-hover",onClick:()=>c({title:"Search Updated",description:`Displaying results for "${a}"`}),children:[e.jsx(pe,{size:18,className:"mr-2"})," Search"]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border dark:border-dark-border shadow-md",children:e.jsxs("table",{className:"w-full min-w-[600px] text-sm text-left text-foreground dark:text-dark-foreground",children:[e.jsx("thead",{className:"text-xs text-primary dark:text-dark-primary uppercase bg-muted/50 dark:bg-dark-muted/50",children:e.jsxs("tr",{children:[e.jsx(q,{columnKey:"name",sortConfig:t,requestSort:I,className:"min-w-[250px]",children:"Vendor Name"}),e.jsx(q,{columnKey:"balance",sortConfig:t,requestSort:I,isTextRight:!0,children:"Balance"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center w-28",children:"Actions"})]})}),e.jsxs("tbody",{children:[T.map(r=>e.jsxs("tr",{className:"bg-card dark:bg-dark-card border-b border-border dark:border-dark-border last:border-b-0 hover:bg-muted/30 dark:hover:bg-dark-muted/30 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-secondary dark:text-dark-secondary hover:underline cursor-pointer",onClick:()=>c({title:`View Ledger: ${r.name}`,description:"Detailed vendor ledger view coming soon."}),children:r.name}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold",children:r.balanceFormatted}),e.jsxs("td",{className:"px-4 py-3 text-center space-x-1",children:[e.jsx(f,{variant:"ghost",size:"icon",className:"text-secondary dark:text-dark-secondary hover:text-accent dark:hover:text-dark-accent h-8 w-8",onClick:()=>S(r),children:e.jsx(ue,{size:16})}),e.jsx(f,{variant:"ghost",size:"icon",className:"text-destructive dark:text-red-400 hover:text-destructive/80 dark:hover:text-red-300 h-8 w-8",onClick:()=>A(r.id),children:e.jsx(he,{size:16})})]})]},r.id)),T.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-10 text-muted-foreground dark:text-dark-muted-foreground",children:a?`No vendors found for "${a}".`:"No vendors found. Add your first vendor!"})})]})]})})]})]})})};export{Be as default};

import{u as G,r as s,j as e,B as j}from"./index-fe6d2e52.js";import{I as U}from"./input-e5a38bac.js";import{D as Y,a as Q,b as W,c as Z,d as M,e as ee,f as ae,g as re,h as q,i as te,j as ce,A as ne,k as se,l as oe,m as le,n as de,o as ie,p as ue,q as me}from"./alert-dialog-e8612541.js";import{L as C}from"./label-1a727cef.js";import{D as pe}from"./date-picker-3c1e787d.js";import{S as _,a as K,b as H,c as E,d as V}from"./select-ae6383b7.js";import{S as J}from"./save-39dd484b.js";import{C as xe,a as he,b as ge,c as be}from"./card-00c50818.js";import{F as fe}from"./file-down-f6f92ad8.js";import{P as Ne}from"./plus-circle-ee65b1db.js";import{S as je,P as ke,A as ye}from"./search-c0fd07d3.js";import{T as Ae}from"./trash-2-fd25eb8f.js";import"./extends-b7a1e135.js";const ve=["Asset","Liability","Equity","Revenue","Expense","Cost of Goods Sold"],T="__none__",Se=({existingAccounts:d=[],onSave:m,onCancel:p,initialData:c,isEditMode:t})=>{const{toast:n}=G(),[h,f]=s.useState(""),[k,g]=s.useState(""),[y,w]=s.useState(""),[b,x]=s.useState(T),[D,A]=s.useState(""),[v,O]=s.useState(void 0),[S,F]=s.useState(null);s.useEffect(()=>{var r;t&&c?(f(c.accName||""),g(c.accNum||""),w(c.accType||""),x(c.subAccountOf||T),A(((r=c.openingBalance)==null?void 0:r.toString())||""),O(c.openingBalanceDate?new Date(c.openingBalanceDate):void 0),F(c.id||c.accNum)):I()},[c,t]);const I=()=>{f(""),g(""),w(""),x(T),A(""),O(void 0),F(null)},L=(r,N=!0)=>{if(r.preventDefault(),!h||!y){n({title:"Validation Error",description:"Account Name and Account Type are required.",variant:"destructive"});return}const $={id:S||`acc-${Date.now()}`,accName:h,accNum:k||S&&S.split("-")[1]||String(Date.now()).slice(-4),accType:y,subAccountOf:b===T?null:b,openingBalance:parseFloat(D)||0,openingBalanceDate:v?v.toISOString().split("T")[0]:null};m($,t),n({title:`Account ${t?"Updated":"Saved"}!`,description:`${h} has been successfully ${t?"updated":"added"}.`}),N?p():t||I()};return e.jsxs("form",{onSubmit:r=>L(r,!0),className:"space-y-4 py-2",children:[e.jsxs(Y,{className:"hidden",children:[e.jsx(Q,{children:t?"Edit Account":"Add New Account"}),e.jsx(W,{children:t?"Update the details of the existing account.":"Fill in the details to create a new account."})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"accountName",children:["Account Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(U,{id:"accountName",value:h,onChange:r=>f(r.target.value),placeholder:"e.g., Main Bank Account",className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"accountNumber",children:"Account Number"}),e.jsx(U,{id:"accountNumber",value:k,onChange:r=>g(r.target.value),placeholder:"e.g., 1010",className:"mt-1",disabled:t}),t&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Account number cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"accountType",children:["Account Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(_,{onValueChange:w,value:y,required:!0,children:[e.jsx(K,{id:"accountType",className:"w-full mt-1",children:e.jsx(H,{placeholder:"Select account type"})}),e.jsx(E,{children:ve.map(r=>e.jsx(V,{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"subAccountOf",children:"Sub-Account of"}),e.jsxs(_,{onValueChange:x,value:b,children:[e.jsx(K,{id:"subAccountOf",className:"w-full mt-1",children:e.jsx(H,{placeholder:"Select parent account (optional)"})}),e.jsxs(E,{children:[e.jsx(V,{value:T,children:"None"}),d.filter(r=>r.accNum!==S).map(r=>e.jsxs(V,{value:r.accNum,children:[r.accName," (",r.accNum,")"]},r.accNum))]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openingBalance",children:"Opening Balance"}),e.jsx(U,{id:"openingBalance",type:"number",value:D,onChange:r=>A(r.target.value),placeholder:"0.00",className:"mt-1",disabled:t}),t&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openingBalanceDate",children:"Opening Balance As of Date"}),e.jsx("div",{children:e.jsx(pe,{date:v,setDate:O,className:"mt-1 w-full",disabled:t})}),t&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance date cannot be changed after creation."})]}),e.jsxs(Z,{className:"pt-6",children:[e.jsx(M,{asChild:!0,children:e.jsx(j,{variant:"outline",onClick:p,children:"Cancel"})}),!t&&e.jsxs(j,{type:"button",onClick:r=>L(r,!1),variant:"secondary",children:[e.jsx(J,{size:18,className:"mr-2"})," Save & New"]}),e.jsxs(j,{type:"submit",children:[e.jsx(J,{size:18,className:"mr-2"})," ",t?"Update Account":"Save & Close"]})]})]})},R=[{sl:1,id:"acc-1001",accNum:"1001",accName:"Cash on Hand",accType:"Asset",balance:5e3,openingBalance:5e3,openingBalanceDate:"2023-01-01",subAccountOf:null},{sl:2,id:"acc-1002",accNum:"1002",accName:"Accounts Receivable",accType:"Asset",balance:12500,openingBalance:12500,openingBalanceDate:"2023-01-01",subAccountOf:null},{sl:3,id:"acc-2001",accNum:"2001",accName:"Accounts Payable",accType:"Liability",balance:7200,openingBalance:7200,openingBalanceDate:"2023-01-01",subAccountOf:null},{sl:4,id:"acc-4001",accNum:"4001",accName:"Sales Revenue",accType:"Revenue",balance:25e3,openingBalance:25e3,openingBalanceDate:"2023-01-01",subAccountOf:null},{sl:5,id:"acc-1003",accNum:"1003",accName:"Petty Cash",accType:"Asset",balance:500,openingBalance:500,openingBalanceDate:"2023-01-01",subAccountOf:"1001"},{sl:6,id:"acc-5001",accNum:"5001",accName:"Office Expenses",accType:"Expense",balance:1200,openingBalance:1200,openingBalanceDate:"2023-01-01",subAccountOf:null}],z=d=>({...d,balanceFormatted:(d.balance||0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),B=({children:d,columnKey:m,sortConfig:p,requestSort:c,isTextRight:t=!1,className:n=""})=>{const h=p&&p.key===m,f=h?p.direction:null;return e.jsx("th",{scope:"col",className:`px-4 py-3 cursor-pointer hover:bg-primary/10 dark:hover:bg-dark-primary/10 transition-colors ${t?"text-right":"text-left"} ${n}`,onClick:()=>c(m),children:e.jsxs("div",{className:`flex items-center ${t?"justify-end":"justify-start"}`,children:[!t&&d,e.jsx("span",{className:`mx-1 ${t?"mr-0 ml-1":"ml-0 mr-1"}`,children:h?f==="ascending"?"▲":"▼":e.jsx(ye,{size:14,className:"opacity-40"})}),t&&d]})})},Pe=()=>{const{toast:d}=G(),[m,p]=s.useState(()=>R.map(z)),[c,t]=s.useState(""),[n,h]=s.useState({key:"sl",direction:"ascending"}),[f,k]=s.useState(!1),[g,y]=s.useState(null),[w,b]=s.useState(!1),[x,D]=s.useState(null);s.useEffect(()=>{const a=localStorage.getItem("chartOfAccounts");a?p(JSON.parse(a).map(z)):localStorage.setItem("chartOfAccounts",JSON.stringify(R))},[]);const A=a=>{localStorage.setItem("chartOfAccounts",JSON.stringify(a.map(({balanceFormatted:o,...i})=>i)))},v=(a=null)=>{y(a),k(!0)},O=()=>{k(!1),y(null)},S=(a,o)=>{p(i=>{let l;if(o)l=i.map(u=>u.id===a.id?z({...u,...a,balance:a.openingBalance}):u);else{const u=i.length>0?Math.max(...i.map(X=>X.sl))+1:1,P=z({...a,sl:u,balance:a.openingBalance});l=[...i,P]}return A(l),l})},F=a=>{const o=m.find(i=>i.id===a);o&&(D(o),b(!0))},I=()=>{if(x){const a=m.filter(o=>o.id!==x.id);p(a),A(a),d({title:"Account Deleted",description:`${x.accName} has been deleted.`,variant:"destructive"}),b(!1),D(null)}},L=()=>{d({title:"Import from Excel",description:"This feature will be available soon.",duration:3e3})},r=a=>t(a.target.value),N=a=>{let o="ascending";n&&n.key===a&&n.direction==="ascending"&&(o="descending"),h({key:a,direction:o})},$=s.useMemo(()=>{let a=[...m];if(c){const o=c.toLowerCase();a=a.filter(i=>Object.values(i).some(l=>String(l).toLowerCase().includes(o)))}return n!==null&&a.sort((o,i)=>{let l=o[n.key],u=i[n.key];return["balance","sl","openingBalance"].includes(n.key)?(l=parseFloat(l)||0,u=parseFloat(u)||0):typeof l=="string"&&(l=l.toLowerCase(),u=u.toLowerCase()),l<u?n.direction==="ascending"?-1:1:l>u?n.direction==="ascending"?1:-1:0}),a},[c,n,m]);return e.jsx("div",{className:"space-y-6 p-1",children:e.jsxs(xe,{className:"shadow-lg border-border dark:border-dark-border",children:[e.jsx(he,{className:"bg-card dark:bg-dark-card rounded-t-lg p-4 md:p-6 border-b border-border dark:border-dark-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsxs(ge,{className:"text-2xl md:text-3xl font-bold text-primary dark:text-dark-primary flex items-center",children:[e.jsx(fe,{size:28,className:"mr-3 text-accent dark:text-dark-accent"})," Chart of Accounts"]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(ee,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"text-primary dark:text-dark-primary border-primary dark:border-dark-primary hover:bg-primary/10 dark:hover:bg-dark-primary/10 shadow-sm",children:[e.jsx(Ne,{size:20,className:"mr-2"})," Add Account"]})}),e.jsxs(re,{align:"end",className:"bg-card dark:bg-dark-card shadow-lg rounded-md border border-border dark:border-dark-border",children:[e.jsx(q,{onClick:()=>v(null),className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Add New"}),e.jsx(q,{onClick:L,className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Import from Excel"})]})]})})]})}),e.jsxs(be,{className:"p-4 md:p-6",children:[e.jsx(te,{open:f,onOpenChange:k,children:e.jsxs(ce,{className:"sm:max-w-[550px] bg-card dark:bg-dark-card text-foreground dark:text-dark-foreground border-border dark:border-dark-border shadow-2xl rounded-lg",children:[e.jsxs(Y,{children:[e.jsx(Q,{className:"text-primary dark:text-dark-primary text-2xl font-semibold",children:g?"Edit Account":"Add New Account"}),e.jsx(W,{className:"text-muted-foreground dark:text-dark-muted-foreground",children:g?"Update the account details.":"Fill in the details to create a new account."})]}),e.jsx(Se,{existingAccounts:m,onSave:S,onCancel:O,initialData:g,isEditMode:!!g})]})}),e.jsx(ne,{open:w,onOpenChange:b,children:e.jsxs(se,{children:[e.jsxs(oe,{children:[e.jsx(le,{children:"Are you absolutely sure?"}),e.jsxs(de,{children:['This action cannot be undone. This will permanently delete the account "',x==null?void 0:x.accName,'".']})]}),e.jsxs(ie,{children:[e.jsx(ue,{onClick:()=>b(!1),children:"Cancel"}),e.jsx(me,{onClick:I,className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete account"})]})]})}),e.jsxs("div",{className:"mb-6 flex items-center space-x-2 p-3 bg-background dark:bg-dark-background rounded-lg shadow-sm border border-border dark:border-dark-border",children:[e.jsx(U,{type:"text",placeholder:"Search accounts (Sl No, Name, Type...)",className:"flex-grow focus:ring-accent dark:focus:ring-dark-accent border-input dark:border-dark-input focus:border-primary dark:focus:border-dark-primary",value:c,onChange:r}),e.jsxs(j,{className:"bg-primary text-primary-foreground hover:bg-primary-hover dark:bg-dark-primary dark:text-dark-primary-foreground dark:hover:bg-dark-primary-hover",onClick:()=>d({title:"Search Updated",description:`Displaying results for "${c}"`}),children:[e.jsx(je,{size:18,className:"mr-2"})," Search"]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border dark:border-dark-border shadow-md",children:e.jsxs("table",{className:"w-full min-w-[800px] text-sm text-left text-foreground dark:text-dark-foreground",children:[e.jsx("thead",{className:"text-xs text-primary dark:text-dark-primary uppercase bg-muted/50 dark:bg-dark-muted/50",children:e.jsxs("tr",{children:[e.jsx(B,{columnKey:"sl",sortConfig:n,requestSort:N,className:"w-16",children:"Sl"}),e.jsx(B,{columnKey:"accNum",sortConfig:n,requestSort:N,children:"Acc. No."}),e.jsx(B,{columnKey:"accName",sortConfig:n,requestSort:N,className:"min-w-[250px]",children:"Account Name"}),e.jsx(B,{columnKey:"accType",sortConfig:n,requestSort:N,children:"Type"}),e.jsx(B,{columnKey:"balance",sortConfig:n,requestSort:N,isTextRight:!0,children:"Balance"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center w-28",children:"Actions"})]})}),e.jsxs("tbody",{children:[$.map(a=>e.jsxs("tr",{className:"bg-card dark:bg-dark-card border-b border-border dark:border-dark-border last:border-b-0 hover:bg-muted/30 dark:hover:bg-dark-muted/30 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3",children:a.sl}),e.jsx("td",{className:"px-4 py-3 text-xs font-mono",children:a.accNum}),e.jsx("td",{className:"px-4 py-3 font-medium text-secondary dark:text-dark-secondary hover:underline cursor-pointer",onClick:()=>d({title:`View Ledger: ${a.accName}`,description:"Detailed ledger view coming soon."}),children:a.accName}),e.jsx("td",{className:"px-4 py-3",children:a.accType}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold hover:underline cursor-pointer text-primary dark:text-dark-primary",onClick:()=>d({title:`View Ledger: ${a.accName}`,description:"Detailed ledger view coming soon."}),children:a.balanceFormatted}),e.jsxs("td",{className:"px-4 py-3 text-center space-x-1",children:[e.jsx(j,{variant:"ghost",size:"icon",className:"text-secondary dark:text-dark-secondary hover:text-accent dark:hover:text-dark-accent h-8 w-8",onClick:()=>v(a),children:e.jsx(ke,{size:16})}),e.jsx(j,{variant:"ghost",size:"icon",className:"text-destructive dark:text-red-400 hover:text-destructive/80 dark:hover:text-red-300 h-8 w-8",onClick:()=>F(a.id),children:e.jsx(Ae,{size:16})})]})]},a.id)),$.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-10 text-muted-foreground dark:text-dark-muted-foreground",children:c?`No accounts found for "${c}".`:"No accounts found. Get started by adding an account!"})})]})]})})]})]})})};export{Pe as default};
